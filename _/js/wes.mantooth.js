var $w={boolLog:!1,objects:{},refs:[],assets:{img:[],audio:[],midi:[],scripts:[],link:[]},main:{width:0,height:0},log:function(a){this.boolLog&&void 0!==window.console&&console.log(a)},slocation:function(){for(var a=document.getElementsByTagName("script"),b=a.length,c="",d=0;b>d;d++)a[d].src.indexOf("wes.mantooth.js")>-1&&(c=a[d].src,c=c.replace(c.substr(c.indexOf("wes.mantooth.js"),c.length),""),c=c.replace("components/",""));return c},makeFPS:function(a){"undefined"==typeof a&&(a=!0),a=a?"show":"";var b=document.createElement("div");b.setAttribute("id","wm_show_fps"),b.setAttribute("class",a),document.getElementsByTagName("body")[0].appendChild(b)},upFPS:function(a){"undefined"==typeof a&&(a=document.getElementById("wm_show_fps")),a.innerHTML=countFPS()+" fps"},loop:function(){for(var a in this.objects)if(this.objects.hasOwnProperty(a))for(var b in this.objects[a])this.objects[a][b].loop()},add_object:function(a,b,c,d,e,f){return $w.game.add_object(a,b,c,d,e,f)},all:function(a,b,c,d){for(var e=a.length,f=0;e>f;f++)d.i=f,$w.objects[b][f][c](d)}};$w.buttons=function(){"use strict";function a(a,c,d,e,f,g,h,i,j){var k=c,l=d;"undefined"!=typeof h.text.padding&&(k+=h.text.padding,l+=h.text.padding),$w.canvas.roundRectangle(a,c,d,e,f,g,h.button.color,h.button.fill,h.button.acolor,h.button.opacity),$w.canvas.text(a,k,l,i,h.text.fill,h.text.font,h.text.color),"undefined"!=typeof j&&($w.mouse.trackMouse(document,function(m){if("function"==typeof j.hover)if(m.x>c&&m.x<c+e&&m.y>d&&m.y<d+f){$w.canvas.roundRectangle(a,c,d,e,f,g,h.button.hcolor,h.button.fill,h.button.acolor,h.button.opacity);var n=h.text.color;"undefined"!=typeof h.text.hcolor&&(n=h.text.hcolor),$w.canvas.text(a,k,l,i,h.text.fill,h.text.font,n),b||(b=!0,j.hover())}else $w.canvas.roundRectangle(a,c,d,e,f,g,h.button.color,h.button.fill,h.button.acolor,h.button.opacity),$w.canvas.text(a,k,l,i,h.text.fill,h.text.font,h.text.color),b=!1}),"function"==typeof j.click&&document.addEventListener("click",function(a){a.clientX>c&&a.clientX<c+e&&a.clientY>d&&a.clientY<d+f&&j.click()}))}var b=!1;return{pill:a}}(),$w.canvas=function(){"use strict";var a,b=!1,c=[],d="12px serif",e="#000000",f=1,g=[],h=function(d,e,f,g){"undefined"==typeof d&&(d=document.getElementsByTagName("body")[0]),"undefined"==typeof e&&(e=window.innerWidth),"undefined"==typeof f&&(f=window.innerHeight),a=document.createElement("canvas"),a.setAttribute("width",e),a.setAttribute("height",f),a.setAttribute("style","z-index:"+(c.length+1)),d.appendChild(a);var h=c.length;return c.push(a.getContext("2d")),b=!0,"function"==typeof g&&g(h),h},i=function(a,b,d,f,g,h,i){"undefined"==typeof i&&(b=~~b,d=~~d),"undefined"==typeof g&&(g=e),"undefined"!=typeof h&&(c[a].globalAlpha=h),c[a].fillStyle=g,c[a].beginPath(),c[a].arc(b,d,f,0,2*Math.PI,!0),c[a].closePath(),c[a].fill()},j=function(a,b,d,f,g,h,i,j,k){"undefined"==typeof k&&(b=~~b,d=~~d),"undefined"==typeof j&&(j=e),c[a].beginPath(),c[a].strokeStyle=j,c[a].arc(b,d,f,g,h,i),c[a].stroke()},k=function(a,b,d,f,g,h,i,j,k){"undefined"==typeof k&&(b=~~b,d=~~d,f=~~f,g=~~g,h=~~h,i=~~i),"undefined"==typeof j&&(j=e),c[a].beginPath(),c[a].strokeStyle=j,c[a].moveTo(b,d),c[a].quadraticCurveTo(f,g,h,i),c[a].stroke()},l=function(a,b,d,f,g,h,i,j,k,l,m){"undefined"==typeof m&&(b=~~b,d=~~d,f=~~f,g=~~g,h=~~h,i=~~i,j=~~j,k=~~k),"undefined"==typeof l&&(l=e),c[a].beginPath(),c[a].strokeStyle=l,c[a].moveTo(b,d),c[a].bezierCurveTo(f,g,h,i,j,k),c[a].stroke()},m=function(a,b,e,f,g,h,i,j){$w.log("$w.text("+[a,b,e,f,g,h,i,j]+")"),"undefined"==typeof j&&(b=~~b,e=~~e),"undefined"==typeof h&&(h=d),"undefined"==typeof g&&(g="fill"),"undefined"!=typeof h&&(c[a].strokeStyle=i,c[a].fillStyle=i),c[a].font=h,"fill"==g?c[a].fillText(f,b,e):c[a].strokeText(f,b,e)},n=function(a,b,d,g,h,i,j,k){"undefined"==typeof k&&(b=~~b,d=~~d,g=~~g,h=~~h),"undefined"==typeof i&&(i=e),"undefined"==typeof j&&(j=f),c[a].beginPath(),c[a].moveTo(b,d),c[a].lineTo(g,h),c[a].lineWidth=j,c[a].strokeStyle=i,c[a].stroke(),c[a].closePath()},o=function(a,b,d,e,f,g,h,i,j,k){switch("undefined"==typeof k&&(b=~~b,d=~~d,e=~~e,f=~~f),"undefined"==typeof h&&(h="stroke"),h){case"fill":c[a].fillStyle=g,"undefined"!=typeof j&&(c[a].globalAlpha=j),c[a].fillRect(b,d,e,f);break;case"stroke":c[a].strokeStyle=g,c[a].strokeRect(b,d,e,f);break;default:c[a].fillStyle=i,"undefined"!=typeof j&&(c[a].globalAlpha=j),c[a].fillRect(b,d,e,f),c[a].strokeStyle=g,c[a].strokeRect(b,d,e,f)}},p=function(a,b,d,e,f,g,h,i,j,k){switch(c[a].beginPath(),c[a].moveTo(b,d+g),c[a].lineTo(b,d+f-g),c[a].arcTo(b,d+f,b+g,d+f,g),c[a].lineTo(b+e-g,d+f),c[a].arcTo(b+e,d+f,b+e,d+f-g,g),c[a].lineTo(b+e,d+g),c[a].arcTo(b+e,d,b+e-g,d,g),c[a].lineTo(b+g,d),c[a].arcTo(b,d,b,d+g,g),"undefined"==typeof i&&(i="stroke"),i){case"fill":c[a].fillStyle=h,"undefined"!=typeof k&&(c[a].globalAlpha=k),c[a].fill();break;case"stroke":c[a].strokeStyle=h,c[a].stroke();break;default:c[a].fillStyle=j,"undefined"!=typeof k&&(c[a].globalAlpha=k),c[a].fill(),c[a].strokeStyle=h,c[a].stroke()}c[a].stroke()},q=function(a,b,d,e,f,g,h){switch("undefined"==typeof h&&(h=!1),"undefined"==typeof e&&(e="stroke"),e){case"fill":c[a].fillStyle=d,"undefined"!=typeof g&&(c[a].globalAlpha=g);break;case"stroke":c[a].strokeStyle=d;break;default:c[a].fillStyle=f,"undefined"!=typeof g&&(c[a].globalAlpha=g),c[a].fillRect(x1,y1,x2,y2),c[a].strokeStyle=d}c[a].beginPath(),c[a].moveTo(b[0][0],b[0][1]);for(var i=b.length,j=1;i>j;j++)c[a].lineTo(b[j][0],b[j][1]);c[a].fill()},r=function(a,b,d){return s(a),c[a].save(),"undefined"==typeof d&&(b.sx=Math.floor(b.sx),b.sy=Math.floor(b.sy),b.sWidth=Math.floor(b.sWidth),b.sHeight=Math.floor(b.sHeight),b.dx=Math.floor(b.dx),b.dy=Math.floor(b.dy),b.dWidth=Math.floor(b.dWidth),b.dHeight=Math.floor(b.dHeight)),"undefined"==typeof b.img?(u("image not set"),!1):("undefined"!=typeof b.sWidth?c[a].drawImage(b.img,b.sx,b.sy,b.sWidth,b.sHeight,b.dx,b.dy,b.dWidth,b.dHeight):"undefined"!=typeof b.dWidth?c[a].drawImage(b.img,b.dx,b.dy,b.dWidth,b.dHeight):c[a].drawImage(b.img,b.dx,b.dy),c[a].restore(),!0)},s=function(b,d){"undefined"==typeof d||d?c[b].clearRect(0,0,a.width,a.height):(c[b].save(),c[b].setTransform(1,0,0,1,0,0),c[b].clearRect(0,0,a.width,a.height),c[b].restore())},t=function(b,d){switch(d){case"canvas":d=a;break;case"ctx":d=c[b]}return d},u=function(a){g.push("Error: "+a)},v=function(){if(g.length>0)for(var a=g.length,b=0;a>b;b++)$w.log(g[b])};return{init:h,circle:i,arc:j,qArc:k,bArc:l,text:m,line:n,image:r,rectangle:o,roundRectangle:p,polygon:q,clear:s,get:t,has_error:v}}(),$w.collision={checkCollision:function(a,b){for(var c=new Array(a.x-a.negXcollisionBox,a.x+a.posXcollisionBox),d=new Array(a.y-a.negYcollisionBox,a.y+a.posYcollisionBox),e=0;2>e;e++)for(var f=0;2>f;f++)if(c[e]>b.x-b.negXcollisionBox&&c[e]<b.x+b.posXcollisionBox&&d[f]>b.y-b.negYcollisionBox&&d[f]<b.y+b.posYcollisionBox)return!0;return!1},checkCollisionCoords:function(a,b,c,d,e){new Array(a-e,a+e),new Array(d-e,d+e);return a>c-e&&c+e>a&&b>d-e&&d+e>b},square:function(a,b,c,d,e,f){},circle:function(a,b){for(var c=a.length,d=0;c>d;d++){var e=$w.motion.distance_to_point(a[d][0],a[d][1],b.x,b.y);if(e-b.radius<0)return!0}return!1},checkCircle:function(a,b,c,d,e,f){var g=$w.motion.distance_to_point(a,b,d,e),h=c+f;return g-h>0},insideCanvas:function(a,b,c){"undefined"==typeof a&&(a=0);var d=$w.canvas.get(a,"canvas").width,e=$w.canvas.get(a,"canvas").height;return 0>b?1:b>d?3:c>e?4:0>c?2:0},inside:function(a,b){for(var c=a[0],d=a[1],e=!1,f=0,g=b.length-1;f<b.length;g=f++){var h=b[f][0],i=b[f][1],j=b[g][0],k=b[g][1],l=i>d!=k>d&&(j-h)*(d-i)/(k-i)+h>c;l&&(e=!e)}return e}},$w.color={componentToHex:function(a){var b=a.toString(16);return 1==b.length?"0"+b:b},rgbToHex:function(a,b,c){return"#"+this.componentToHex(a)+this.componentToHex(b)+this.componentToHex(c)},random:function(){for(var a=[],b=0;3>b;b++)a.push(~~(255*Math.random()));return $w.color.rgbToHex(a[0],a[1],a[2])}},$w.draw=function(){"use strict";var a=function(a,b,c,d,e){$w.log("$w.grid("+[a,b,c,d]+")");for(var f=b/(10*d),g=1;b>g;g+=f)$w.canvas.line(a,g,0,g,c,"#dedede");for(var h=1;c>h;h+=f)$w.canvas.line(a,0,h,b,h,"#dedede");$w.canvas.line(a,0,b/2,b,c/2,"#000000",2),$w.canvas.line(a,c/2,0,b/2,c,"#000000",2),"function"==typeof e&&e()};return{grid:a}}(),$w.game={map:{},add_object:function(a,b,c,d,e,f){for(var g=[],h=0;a>h;h++){var i=$w.canvas.init(d,e,f);c.i=i,"object"==typeof $w.objects[b.name]?$w.objects[b.name][i]=new b(c):($w.objects[b.name]=[],$w.objects[b.name][i]=new b(c)),g.push(i)}return g},bindkeys:function(a,b,c){switch($w.log("Game.key."+b),"undefined"==typeof $w.game.map[b]&&($w.game.map[b]=[]),$w.game.map[b].push(a),"undefined"==typeof c&&(c=document),b){case"keydown":c.addEventListener("keydown",function(a){$w.game.key(a,b)});break;case"keypress":c.addEventListener("keypress",function(a){$w.game.key(a,b)});break;default:c.addEventListener("keyup",function(a){$w.game.key(a,b)})}},key:function(a,b){$w.log("Game.key."+b),$w.log(a);for(var c=$w.game.map[b].length,d=0;c>d;d++){var e=$w.game.map[b][d];for(var f in e)e.hasOwnProperty(f)&&a.code==f&&e[f](a)}}},$w.loading=function(){"use strict";var a=[],b=[".jpg",".gif",".png",".svg"],c={loaders:["loading1.gif","loading2.gif"],loaded:0,loading:null,timeout:1e4},d=function(a,d,e,f){c.assets_path=$w.slocation()+"../assets/loaders/","undefined"==typeof e&&(e="");var g=document.createElement("div");if(g.setAttribute("class","loader_fader "+e),g.setAttribute("style","width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px"),"undefined"==typeof c.loaders[d]){if(k("selected loader reference does not exist"),"function"!=typeof f)return!1;f(!1)}var h=document.createElement("div");h.setAttribute("class","loader_container "+e),h.setAttribute("style","width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px");var i=/\.[0-9a-z]+$/i;if(b.indexOf(c.loaders[d].match(i)[0])>-1){var j=document.createElement("img");j.setAttribute("src",c.assets_path+c.loaders[d]),h.appendChild(j)}else h.innerHTML=c.loaders[d];return a.appendChild(g),a.appendChild(h),"function"==typeof f&&f(!0),!0},e=function(a,b){var d=Object.keys(a).length,e=0,m=/\.[0-9a-z]+$/i;for(var n in a)if(a.hasOwnProperty(n)){var o=a[n].match(m)[0];switch(o){case".jpg":case".gif":case".png":case".svg":case".bmp":g(a[n],n);break;case".js":case".json":j(a[n],n);break;case".txt":case".css":i(a[n],n);break;case".ogg":case".mp3":h(a[n],n);break;case".midi":break;case".mp4":break;default:k("requested MIME type not supported"),b(!1)}l()}c.loading=setInterval(function(){c.loaded==d&&f(function(){clearInterval(c.loading),b(!0)}),e++,e>=c.timeout&&(k("assets failed to load, process timed out"),b(!1))},100)},f=function(a){$w.log("Loading.complete");for(var b=["loader_fader","loader_container"],c=0;2>=c;c++)for(var d=document.getElementsByClassName(b[c]),e=d.length,f=0;e>f;f++)d[f].parentElement.removeChild(d[f]);a()},g=function(a,b){$w.log("Loading.load_images "+a);var d=new Image;d.src=a,d.onload=function(){$w.assets.img[b]=d,c.loaded++}},h=function(a,b){$w.log("Loading.load_audio "+a);var d=new Audio(a);d.oncanplaythrough=function(){$w.assets.audio[b]=d,c.loaded++}},i=function(a,b){if("undefined"==typeof a.rel)return k("Loading.load_link param l.rel is a required field"),!1;if("undefined"==typeof a.href)return k("Loading.load_link param l.href is a required field"),!1;var d=document.createElement("link");return d.setAttribute("rel",a.rel),d.setAttribute("href",a.href),document.getElementsByName("head").appendChild(d),$w.assets.link[b]=d,c.loaded++,!0},j=function(a,b){if("undefined"==typeof a.src)return k("Loading.load_script param l.src is a required field"),!1;var d=document.createElement("script");return"undefined"!=typeof a.type&&d.setAttribute("type",a.type),"undefined"!=typeof a.integrity&&d.setAttribute("integrity",a.integrity),"undefined"!=typeof a.crossorigin&&d.setAttribute("crossorigin",a.crossorigin),d.setAttribute("src",a.src),document.getElementsByName("head").appendChild(d),$w.assets.script[b]=link,c.loaded++,!0},k=function(b){a.push("Error: "+b)},l=function(){if(a.length>0){for(var b=a.length,c=0;b>c;c++)$w.log(a[c]);return!0}return!1},m=function(a,b){c[a]=b};return{init:d,load:e,setO_val:m,has_error:l}}(),$w.math={radians:function(a){return a*Math.PI/180},degrees:function(a){return 180*a/Math.PI},sqr:function(a){return a*a},dist:function(a,b,c,d){return Math.hypot(c-a,d-b)},frandom:function(a){return~~(Math.random()*a)}},window.countFPS=function(){var a=(new Date).getMilliseconds(),b=1,c=0;return function(){var d=(new Date).getMilliseconds();return a>d?(c=b,b=1):b+=1,a=d,c}}(),$w.motion={distance_to_point:function(a,b,c,d){return Math.hypot(c-a,d-b)},point_direction:function(a,b,c,d,e){var f=c-a,g=d-b,h=Math.atan2(g,f),i=h*(180/Math.PI);return 0>i&&(i+=360),e?h:i},motion_set:function(a,b,c,d){var e=c*(Math.PI/180);return a+=Math.cos(e)*Math.PI/180*d,b+=Math.sin(e)*Math.PI/180*d,[a,b]},motion_set_2:function(a,b){var c=a.position.x,d=a.position.y,e=a.rotation.z;return c+=Math.cos(e)*Math.PI/180*b,d+=Math.sin(e)*Math.PI/180*b,a.position.x=c,a.position.y=d,a},move_to_contact:function(a,b,c,d,e){var f=new Object,g=d*(Math.PI/180);return a+=Math.cos(g)*Math.PI/180*e,b+=Math.sin(g)*Math.PI/180*e,c+=Math.sin(g)*Math.PI/180*e,f.x=a,f.y=b,f.z=c,f},move_to_contact_2:function(a,b){var c=this.point_direction(a.x,a.y,b.x,b.y);c+=180;var d=15;for(a.speed>1?d=a.speed:b.speed>1&&(d=b.speed);1==this.checkCollision(a,b);){var e=c*(Math.PI/180);a.x+=Math.cos(e)*Math.PI/180*a.speed,a.y+=Math.sin(e)*Math.PI/180*a.speed}}},$w.mouse={mouseX:0,mouseY:0,trackMouse:function(a,b,c){a.addEventListener("mousemove",function(a){this.mouseX=a.clientX,this.mouseY=a.clientY,"function"==typeof b&&b({x:a.clientX,y:a.clientY},c)})}},HTMLElement.prototype.hasClass=function(a){return this.classList?this.classList.contains(a):!!this.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))},HTMLElement.prototype.addClass=function(a){this.classList?this.classList.add(a):this.hasClass(a)||(this.className+=a)},HTMLElement.prototype.removeClass=function(a){if(this.classList)this.classList.remove(a);else if(this.hasClass(a)){var b=new RegExp("(\\s|^)"+a+"(\\s|$)");this.className=this.className.replace(b," ")}},$w.threed={makeA3DPoint:function(a,b,c){var d=new Object;return d.x=a,d.y=b,d.z=c,d},convertPointIn3DToPointIn2D:function(a){var b=new Object,c=focalLength/(focalLength+a.z);return b.x=a.x*c,b.y=a.y*c,b}};